maintainer : Justin
name       : mozjs52
version    : 52.9.0
release    : 1
source     :
    - https://ftp.mozilla.org/pub/firefox/releases/52.9.0esr/source/firefox-52.9.0esr.source.tar.xz : c01d09658c53c1b3a496e353a24dad03b26b81d3b1d099abc26a06f81c199dd6
license    :
    - GPL-2.0
    - MPL-1.1
component  : desktop.library
summary    : JS is Mozilla's JavaScript engine written in C/C++
description: |
    JS is Mozilla's JavaScript engine written in C/C++.
builddeps  :
    - pkgconfig(nspr)
    - autoconf213
setup      : |
    export PYTHON=/usr/bin/python2
    %apply_patches
    head -n -1 config/milestone.txt > config/milestone.txt
    echo "${version}" >> config/milestone.txt
    cd $workdir/js/src
    autoconf213
    %configure --enable-readline \
               --enable-threadsafe \
               --enable-shared-js \
               --with-system-nspr
build      : |
    export PYTHON=/usr/bin/python2
    cd $workdir/js/src
    %make
install    : |
    export PYTHON=/usr/bin/python2
    cd $workdir/js/src
    %make_install
    rm -r $installdir/%libdir%/*.ajs

    # Restore proper versioning and rely on soname only
    mv $installdir/%libdir%/libmozjs-52.so $installdir/%libdir%/libmozjs-52.so.0
    ln -s libmozjs-52.so.0 $installdir/%libdir%/libmozjs-52.so
